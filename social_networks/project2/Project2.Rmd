---
title: "Project 2"
author: "Logan Bolton"
output: pdf_document
date: "2025-02-08"
---

# Setup
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
setwd("/Users/log/Github/Spring2025Classes/social_networks/project2")
D <- read.csv("congress_network/congress.edgelist")
```

```{r}
print("Data structure:")
str(D)
print("First few rows:") 
head(D)

# Load the library
library(igraph) 
library(stringr)
```

```{r}


# Format the data
edges_df <- data.frame(
  from = as.numeric(sub("^(\\d+).*", "\\1", D$X0.4...weight...0.002105263157894737.)),
  to = as.numeric(sub("^\\d+\\s+(\\d+).*", "\\1", D$X0.4...weight...0.002105263157894737.)),
  weight = as.numeric(sub(".*'weight':\\s*([0-9.]+).*", "\\1", D$X0.4...weight...0.002105263157894737.))
)

# Create the graph
g <- graph_from_data_frame(edges_df, directed = TRUE)
```

# Graph Characteristics
## Network Understanding
```{r Network Understanding}
print("Network Order (number of vertices):")
vcount(g)

# Network size (number of edges)
print("Network Size (number of edges):")
ecount(g)

# Network density
print("Network Density:")
edge_density(g)

# Check strong connectivity
components <- components(g, mode="strong")
cat("\nNumber of strongly connected components:", components$no, "\n")
cat("Size of largest strongly connected component:", max(components$csize), "\n")

```

## Degree Distribution
```{r degree distribution}
# Calculate different degree measures
in_deg <- degree(g, mode="in")
out_deg <- degree(g, mode="out")
total_deg <- degree(g, mode="total")

par ( mfrow = c (1 ,2))
hist ( in_deg , main = " In - Degree Distribution " ,
xlab = " In - Degree " , ylab = " Frequency " , col = " lightblue " )
hist ( out_deg , main = " Out - Degree Distribution " ,
xlab = " Out - Degree " , ylab = " Frequency " , col = " lightgreen " )
```

## PageRank
```{r PageRank}
page_rank <- page_rank (g , weights = E ( g ) $weight , directed = TRUE ) $vector
```
## Hub and Authority Scores
_Note:_ The depreciation warning about 'hub_score' and 'authority_score' appears to not actually be true.
``` {r}
hub_scores <- hub_score(g , scale = TRUE ) $vector # Hub scores
auth_scores <- authority_score(g , scale = TRUE ) $vector # Authority scores
```
## Closeness Centrality
``` {r}
harmonic_close <- harmonic_centrality (g , weights = E ( g ) $weight , mode = "out" )

```

## Betweenness Centrality 
``` {r}
betweenness <- betweenness (g , weights = E ( g ) $weight , directed = TRUE , normalized = TRUE )

```

# Nodes
``` {r}
get_top_10 <- function (metric, metric_name) {
  top_indices <- order ( metric , decreasing = TRUE )[1:10]
  data.frame (
  Metric = rep(metric_name, 10) ,
  Node = top_indices ,
  Value = round ( metric [ top_indices ] , 4)
  )
}

top_nodes <- rbind (
  get_top_10 ( in_deg , " In - Degree " ) ,
  get_top_10 ( out_deg , " Out - Degree " ) ,
  get_top_10 ( page_rank , " PageRank " ) ,
  get_top_10 ( harmonic_close , " Harmonic Closeness " ) ,
  get_top_10 ( betweenness , " Betweenness " ) ,
  get_top_10 ( hub_scores, " Hub Scores ") ,
  get_top_10 ( auth_scores, " Authority Scores ")
)
# Print results
print ( " Top 10 nodes by different centrality measures : " )
print ( top_nodes )
```
```{r}
node_freq <- table(top_nodes$Node)

# Convert to dataframe and sort
node_freq_df <- data.frame(
  Node = names(node_freq),
  Frequency = as.numeric(node_freq)
)
node_freq_df <- node_freq_df[order(-node_freq_df$Frequency), ]

# Create the plot using base R
barplot(node_freq_df$Frequency[1:10], 
        names.arg = node_freq_df$Node[1:10],
        main = "Top 10 Most Frequent Nodes",
        xlab = "Node ID",
        ylab = "Frequency",
        las = 2)  # Rotate x-axis labels
```

# Justification


---
title: "Project 5"
output: pdf_document
author: "Logan Bolton"
date: "2025-02-23"
---

_Acknowledgement:_ This code was created through the repurposing of code found in the lecture notes and through collaboration with ChatGPT-4o by OpenAI. AI tools were very helpful for me while fixing errors and determining the correct syntax to plot graphs.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library('igraph')
library(poweRlaw)

```



```{r load_dataset}
url1 <- "https://raw.githubusercontent.com/JeffreyAlanSmith/Integrated_Network_Science/master/data/affiliations_1996.txt"
url2 <- "https://raw.githubusercontent.com/JeffreyAlanSmith/Integrated_Network_Science/master/data/affiliations_1996.txt"

affiliations96 <- read.delim(file = url1, check.names = FALSE)
affiliations97 <- read.delim(file = url2, check.names = FALSE)
dim(affiliations96)
```

# 1 - 1996 Dataset
## a - Which student clubs serve to integrate the school and which are more peripheral?
The most core clubs are the Spanish Club, the Pep Club and NHS. The Choir barbershop quartet (4 men), the Cross Country girls 8th grade team and the boys Swim & Dive Team are the most peripheral clubs.
```{r}
G96 <- graph_from_incidence_matrix(as.matrix(affiliations96))
# Split nodes into types by rows versus columns
# V(G96)$type # TRUE = club, FALSE = student,
clubs <- V(G96)[V(G96)$type == TRUE]

club_degrees <- degree(G96, v = clubs)
# Identify top & bottom
cat("top clubs\n")
head(sort(club_degrees, decreasing = TRUE), 3)  

cat("Peripheral clubs\n")
head(sort(club_degrees, decreasing = FALSE), 3) 
```
## b - Which student clubs tend to share members at high rates?

The following pairs of clubs share the most amount of members:

- Pep Club & Spanish Club
- Debate club & Forensics (National Forensics League)
- Forensics club & Forensics (National Forensics League)
  - "Forensics club" and "Forensics (National Forensics League)" are listed as separate clubs in the dataset, despite having similar names
```{r}
projections <- bipartite_projection(G96)
club_graph <- projections$proj2  # This is the club-club graph

# Weight = number of shared members
E(club_graph)$weight

# Top pairs with highest shared members
top_pairs <- as_data_frame(club_graph, what = "edges")
top_pairs <- top_pairs[order(-top_pairs$weight), ]
head(top_pairs, 3)
```
## c - What is the shared feature, or theme, that brings these clubs together in a cluster?

When analyzing the clusters based off the walktrap algorithm, the majority of the clubs in the clusters share the following common traits:

- Cluster 1
  - Girls 8th grade sports teams
- Cluster 2
  - High school boys sports teams
- Cluster 3
  - Boys 8th grade sports teams
- Cluster 4
  - Majority female academic clubs and girls sports
- Cluster 5
  - Academic organizations and girls sports
- Cluster 6
  - 9th grade girls sports
- Cluster 7
  - Music clubs
  
I tried several different clustering methods and the walktrap algorithm gave the most coherent clusters.

```{r}
# club_comm <- cluster_louvain(club_graph)
# club_comm <- cluster_edge_betweenness(club_graph)
club_comm <- cluster_walktrap(club_graph)

club_membership <- membership(club_comm)
club_names <- names(club_membership)

# Combine club names and cluster numbers
club_clusters <- data.frame(
  Club = club_names,
  Cluster = club_membership
)

# View the clubs in each cluster
split(club_clusters$Club, club_clusters$Cluster)
```

# 2 - 1997 Dataset

## a - What is the order, size, and density of G?
```{r}
G <- graph_from_incidence_matrix(as.matrix(affiliations97))

order_G <- gorder(G)
size_G <- gsize(G)
density_G <- edge_density(G)

cat("Order (number of vertices):", order_G, "\n")
cat("Size (number of edges):", size_G, "\n")
cat("Density:", density_G, "\n")
```

## b - Is the network G connected? If not, what fraction of vertices belong to the largest connected component? If the network is not connected, consider only the largest component H for the remaining questions.
```{r}
is_connected(G)
cat("The graph is NOT connected\n\n")

comp <- components(G)

# Size of largest component
largest_comp_size <- max(comp$csize)
fraction_largest <- largest_comp_size / gorder(G)

# Create subgraph H
H <- induced_subgraph(G, which(comp$membership == which.max(comp$csize)))

cat("Percent of vertices belonging to largest component: ", fraction_largest, "\n")
```

## c - What is the average path length of H?
```{r}
average_path_length_H <- average.path.length(H, directed = FALSE)
cat("Average path length: ", average_path_length_H)
```

## d - Is H scale-free? Provide statistical evidence (e.g., by examining the degree distribution and fitting a power-law distribution)

```{r}
deg <- degree(H)
hist(deg, breaks=50, main="Degree Distribution", xlab="Degree")

# Fit power law
fit <- fit_power_law(deg)
fit
```
## e - What is the fraction of edges that are attached to the top 10% of high-degree vertices?

```{r}
m <- displ$new(deg)
est <- estimate_xmin(m)
m$setXmin(est)
plot(m)
lines(m, col="red")
```
## f - What distributions do the following centrality measures follow:

```{r}
# Eigenvector
eigen_centrality <- eigen_centrality(H)$vector
hist(eigen_centrality, main="Eigenvector Centrality", xlab="Centrality")

# Betweenness
betw <- betweenness(H)
hist(betw, main="Betweenness Centrality", xlab="Betweenness")

# Closeness
closeness_centrality <- closeness(H)
hist(closeness_centrality, main="Closeness Centrality", xlab="Closeness")

```

## g - How does the clustering coefficient of vertices change with vertex degrees?
# FIX THIS
```{r}
clustering <- transitivity(H, type = "local", isolates = "zero")
plot(deg, clustering, xlab="Degree", ylab="Clustering Coefficient", main="Clustering vs Degree")

```
## h - Does H exhibit assortative mixing in terms of vertex degrees? Provide the assortativity coefficient and interpret its value.
```{r}
assortativity_degree <- assortativity_degree(H)
assortativity_degree

```

